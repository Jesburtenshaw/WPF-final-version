<UserControl x:Class="CDM.UserControls.CDMUserControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:converter="clr-namespace:CDM.Converters"
             xmlns:local="clr-namespace:CDM.UserControls"
             xmlns:common="clr-namespace:CDM.Common"
             Unloaded="UserControl_Unloaded"
             Loaded="UserControl_Loaded"
             PreviewMouseDown="UserControl_PreviewMouseDown"
             PreviewKeyDown="UserControl_PreviewKeyDown"
             AllowDrop="True"
             DragEnter="UserControl_DragEnter"
             Drop="UserControl_Drop"
             mc:Ignorable="d">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/CDM;component\Themes\Generic.xaml"  />
            </ResourceDictionary.MergedDictionaries>
            <!--<converter:ArrowPathConverter x:Key="ArrowPathConverter" />-->
            <converter:BoolVisibilityConverter x:Key="BoolVisibilityConverter" />
            <converter:BoolVisibilityInverseConverter x:Key="BoolVisibilityInverseConverter" />
            <converter:BoolInverseConverter x:Key="BoolInverseConverter" />
            <converter:DirFileTypeVisibilityConverter x:Key="DirFileTypeVisibilityConverter" />
            <converter:EmptyStringVisibilityConverter x:Key="EmptyStringVisibilityConverter" />
            <converter:EmptyStringVisibilityInverseConverter x:Key="EmptyStringVisibilityInverseConverter" />
            <converter:ZeroIntVisibilityConverter x:Key="ZeroIntVisibilityConverter" />
            <converter:ZeroIntVisibilityInverseConverter x:Key="ZeroIntVisibilityInverseConverter" />
            <converter:DateTimeConverter x:Key="DateTimeConverter" />
        </ResourceDictionary>
    </UserControl.Resources>

    <!--<Grid Background="#484848">-->
    <Grid Background="{DynamicResource WindowBackgroundColor}" Height="{Binding ParentHeight}" Width="{Binding ParentWidth}">
        <Grid.Resources>
            <!--Resources for this usercontrol components-->

            <Style TargetType="ContextMenu">
                <Setter Property="Background" Value="{StaticResource BackgroundBrushContextMenu}"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ContextMenu">
                            <Border Background="{TemplateBinding Background}" BorderBrush="{StaticResource BorderBrushContextMenu}" BorderThickness="2"
                               CornerRadius="10" Padding="0"
                               SnapsToDevicePixels="True">
                                <StackPanel IsItemsHost="True" />
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- Style for the MenuItems -->
            <Style TargetType="MenuItem">
                <Setter Property="Foreground" Value="#1C1C1C"/>
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="FontFamily" Value="Segoe UI"/>
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Height" Value="35"/>
                <Setter Property="Padding" Value="30,5,20,5"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="MenuItem">
                            <Border Background="{TemplateBinding Background}" CornerRadius="8"
                               Padding="{TemplateBinding Padding}">
                                <ContentPresenter ContentSource="Header" 
                                             HorizontalAlignment="Left" 
                                             VerticalAlignment="Center"/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="{StaticResource HoverBrushContextMenu}"/>
                    </Trigger>
                </Style.Triggers>
            </Style>


            <!--Pin, Star, GotoParent button background style-->
            <Style x:Key="PinButtonStyle" TargetType="Button">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border Name="border" CornerRadius="4" Padding="2">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="{DynamicResource PinHoverBackgroundColor}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

        </Grid.Resources>
        <Grid.RowDefinitions>
            <!--<RowDefinition Height="50" />-->
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--<Grid Grid.Row="0">
            <TextBlock FontSize="15"
                       Margin="70 0"
                       Foreground="{DynamicResource WindowForegroundColor}"
                       VerticalAlignment="Center"
                       Text="Open" />
        </Grid>-->

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!--<Grid Grid.Column="0"
                  Margin="60 0 0 0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <Button Grid.Row="0"
                        Height="40"
                        Margin="0 5"
                        Style="{StaticResource sidebarBtnStyle}">
                    <Button.Content>
                        <StackPanel Orientation="Horizontal">
                            <Path Data="M 15 3 C 8.3844276 3 3 8.38443 3 15 C 3 21.61557 8.3844276 27 15 27 C 21.615572 27 27 21.61557 27 15 C 27 8.38443 21.615572 3 15 3 z M 15 5 C 20.534692 5 25 9.46531 25 15 C 25 20.53469 20.534692 25 15 25 C 9.4653079 25 5 20.53469 5 15 C 5 9.46531 9.4653079 5 15 5 z M 15 7 C 14.446 7 14 7.446 14 8 L 14 15 C 14 15.554 14.446 16 15 16 L 22 16 C 22.554 16 23 15.554 23 15 C 23 14.446 22.554 14 22 14 L 16 14 L 16 8 C 16 7.446 15.554 7 15 7 z "
                                  Width="30"
                                  Height="30"
                                  Margin="5,0,10,0"
                                  Style="{StaticResource IcnPathStyle}" />
                            <TextBlock FontSize="15"
                                       Foreground="{DynamicResource WindowForegroundColor}"
                                       VerticalAlignment="Center"
                                       Text="Recent" />
                        </StackPanel>
                    </Button.Content>
                </Button>

                <Border BorderThickness="1"
                        Grid.Row="1"
                        Style="{StaticResource SidebarBorder}">
                    <Button Grid.Row="1"
                            Height="58"
                            Style="{StaticResource sidebarBtnStyle}"
                            HorizontalContentAlignment="Left"
                            Width="Auto">
                        <Button.Content>
                            <StackPanel Margin="5 0 0 0"
                                        Orientation="Horizontal">
                                <Path Style="{StaticResource IcnPathStyle}"
                                      Width="25"
                                      Height="25"
                                      Data="M377.6 499.2C275.2 499.2 192 416 192 316.8s83.2-182.4 182.4-182.4 182.4 83.2 182.4 182.4-80 182.4-179.2 182.4z m0-300.8C310.4 198.4 256 249.6 256 316.8s54.4 118.4 118.4 118.4 118.4-54.4 118.4-118.4-51.2-118.4-115.2-118.4zM665.6 889.6H86.4c-38.4 0-70.4-32-70.4-70.4 0-124.8 121.6-307.2 307.2-307.2h99.2c188.8 0 307.2 182.4 307.2 307.2 6.4 38.4-25.6 70.4-64 70.4zM326.4 576c-147.2 0-243.2 147.2-243.2 243.2 0 3.2 3.2 6.4 6.4 6.4h579.2c3.2 0 6.4-3.2 6.4-6.4 0-96-96-243.2-243.2-243.2h-105.6z" />
                                <Path Style="{StaticResource IcnPathStyle}"
                                      Margin="-5 0 0 0"
                                      Width="15"
                                      Height="20"
                                      Data="M729.6 560c-80 0-147.2-64-147.2-147.2s64-147.2 147.2-147.2 147.2 64 147.2 147.2-67.2 147.2-147.2 147.2z m0-230.4c-44.8 0-83.2 35.2-83.2 83.2s35.2 83.2 83.2 83.2 83.2-35.2 83.2-83.2-38.4-83.2-83.2-83.2zM947.2 889.6h-134.4c-19.2 0-32-12.8-32-32s12.8-32 32-32h131.2c-3.2-70.4-73.6-172.8-176-172.8h-12.8c-19.2 0-32-12.8-32-32s12.8-32 32-32h12.8c147.2 0 240 144 240 240 0 35.2-28.8 60.8-60.8 60.8z" />

                                <TextBlock FontSize="15"
                                           Foreground="{DynamicResource WindowForegroundColor}"
                                           Margin="5 0 0 0"
                                           VerticalAlignment="Center"
                                           Text="Shared With Me" />
                            </StackPanel>
                        </Button.Content>
                    </Button>
                </Border>

                <Separator Grid.Row="2"
                           Margin="10 5" />

                <Border BorderThickness="1"
                        Grid.Row="3"
                        Style="{StaticResource SidebarBorder}">
                    <Button Style="{StaticResource sidebarBtnStyle}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <Grid Margin="5 0 0 0">
                                    <Path Style="{StaticResource IcnPathStyle}"
                                          Width="30"
                                          Height="25"
                                          Data="M895.5 660.5L742 239.7l-0.1-0.4c-6.5-17.1-18-31.6-33-42-15.1-10.4-32.7-15.9-51-15.9h-313c-39 0-73.3 24.9-85.5 61.9l-0.1 0.2L128.2 661c-10.8 18-17 39-17 61.5 0 66.2 53.8 120 120 120h561.6c66.2 0 120-53.8 120-120 0-22.7-6.3-43.9-17.3-62zM306.8 258.9c5.5-16.4 20.7-27.4 38-27.4h313c16.4 0 31.4 10.3 37.3 25.6l127.4 349.1c-9.5-2.4-19.4-3.7-29.7-3.7H231.2c-11.7 0-23.1 1.7-33.8 4.8l109.4-348.4z m486 533.6H231.2c-38.6 0-70-31.4-70-70s31.4-70 70-70h561.6c38.6 0 70 31.4 70 70s-31.4 70-70 70z" />
                                    <Path Margin="0 -8 0 0"
                                          Width="10"
                                          Height="10"
                                          Style="{StaticResource IcnPathStyle}"
                                          Data="M331 543.3c16.1 15.2 37.1 23.6 59.3 23.6h224.3c28 0 54.3-10.9 74.1-30.7 20.6-20.6 31.7-49.1 30.6-78.2-1-27.3-12.6-52.8-32.7-71.7-14.5-13.8-32.4-23-51.6-26.9-9.8-58.3-60.9-102.9-122.2-102.9h-20.3c-33 0-63.9 12.8-87.2 36.1-23.3 23.4-36.1 54.4-36.1 87.3 0 6.5 0.5 13 1.5 19.3-15.5 3.5-29.8 11.3-41.3 22.8-16.5 16.6-25.6 39.5-24.8 62.9 0.7 22.3 10.1 43 26.4 58.4z m33.8-85.9c6.6-6.6 15.4-10.2 24.7-10.2 11 0 21.5-5.3 28-14.2 6.5-8.9 8.4-20.5 5.1-31.1-2.2-7.1-3.4-14.5-3.4-22 0-19.6 7.6-38 21.5-51.9 13.8-13.9 32.2-21.5 51.9-21.5h20.3c40.8 0 73.9 32.9 73.9 73.3v0.4c0 7.2 2.7 14 7.8 19.1 5.1 5.1 11.8 7.9 19 7.9 14.5 0 28.2 5.5 38.7 15.4 10.4 9.9 16.5 23.1 17 37.3 0.6 15.5-5.1 30-16 40.9-10.4 10.4-24.1 16.1-38.8 16.1H390.3c-19.1 0-35.1-15.1-35.7-33.6-0.4-9.8 3.3-19 10.2-25.9z" />
                                </Grid>


                                <StackPanel Orientation="Vertical">
                                    <TextBlock FontSize="15"
                                               Margin="10 0 10 0"
                                               Foreground="{DynamicResource WindowForegroundColor}"
                                               VerticalAlignment="Center"
                                               Text="CDM - IAM Cloud" />
                                    <TextBlock FontSize="12"
                                               Margin="10 0 10 0"
                                               Foreground="{DynamicResource WindowForegroundColor}"
                                               VerticalAlignment="Center"
                                               Text="Test.user@gmail.com" />
                                </StackPanel>
                            </StackPanel>
                        </Button.Content>
                    </Button>
                </Border>

                <Separator Grid.Row="4"
                           Margin="10 5" />

                <Border BorderThickness="1"
                        Grid.Row="5"
                        Style="{StaticResource SidebarBorder}">
                    <Button Grid.Row="5"
                            Style="{StaticResource sidebarBtnStyle}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">

                                <Grid Margin="5 0 10 0">
                                    <Path Style="{StaticResource IcnPathStyle}"
                                          Width="30"
                                          Height="25"
                                          Data="M895.5 660.5L742 239.7l-0.1-0.4c-6.5-17.1-18-31.6-33-42-15.1-10.4-32.7-15.9-51-15.9h-313c-39 0-73.3 24.9-85.5 61.9l-0.1 0.2L128.2 661c-10.8 18-17 39-17 61.5 0 66.2 53.8 120 120 120h561.6c66.2 0 120-53.8 120-120 0-22.7-6.3-43.9-17.3-62zM306.8 258.9c5.5-16.4 20.7-27.4 38-27.4h313c16.4 0 31.4 10.3 37.3 25.6l127.4 349.1c-9.5-2.4-19.4-3.7-29.7-3.7H231.2c-11.7 0-23.1 1.7-33.8 4.8l109.4-348.4z m486 533.6H231.2c-38.6 0-70-31.4-70-70s31.4-70 70-70h561.6c38.6 0 70 31.4 70 70s-31.4 70-70 70z" />
                                    <Path Style="{StaticResource IcnPathStyle}"
                                          Margin="0 -8 0 0"
                                          Width="10"
                                          Height="10"
                                          Data="M331 543.3c16.1 15.2 37.1 23.6 59.3 23.6h224.3c28 0 54.3-10.9 74.1-30.7 20.6-20.6 31.7-49.1 30.6-78.2-1-27.3-12.6-52.8-32.7-71.7-14.5-13.8-32.4-23-51.6-26.9-9.8-58.3-60.9-102.9-122.2-102.9h-20.3c-33 0-63.9 12.8-87.2 36.1-23.3 23.4-36.1 54.4-36.1 87.3 0 6.5 0.5 13 1.5 19.3-15.5 3.5-29.8 11.3-41.3 22.8-16.5 16.6-25.6 39.5-24.8 62.9 0.7 22.3 10.1 43 26.4 58.4z m33.8-85.9c6.6-6.6 15.4-10.2 24.7-10.2 11 0 21.5-5.3 28-14.2 6.5-8.9 8.4-20.5 5.1-31.1-2.2-7.1-3.4-14.5-3.4-22 0-19.6 7.6-38 21.5-51.9 13.8-13.9 32.2-21.5 51.9-21.5h20.3c40.8 0 73.9 32.9 73.9 73.3v0.4c0 7.2 2.7 14 7.8 19.1 5.1 5.1 11.8 7.9 19 7.9 14.5 0 28.2 5.5 38.7 15.4 10.4 9.9 16.5 23.1 17 37.3 0.6 15.5-5.1 30-16 40.9-10.4 10.4-24.1 16.1-38.8 16.1H390.3c-19.1 0-35.1-15.1-35.7-33.6-0.4-9.8 3.3-19 10.2-25.9z" />
                                </Grid>
                                <StackPanel Orientation="Vertical">
                                    <TextBlock FontSize="15"
                                               Foreground="{DynamicResource WindowForegroundColor}"
                                               VerticalAlignment="Center"
                                               Text="OneDrive - IAM Cloud" />
                                    <TextBlock FontSize="12"
                                               Foreground="{DynamicResource WindowForegroundColor}"
                                               VerticalAlignment="Center"
                                               Text="Test.user@gmail.com" />
                                </StackPanel>
                            </StackPanel>
                        </Button.Content>
                    </Button>
                </Border>

                <Separator Grid.Row="6"
                           Margin="10 5" />

                <TextBlock Grid.Row="7"
                           Margin="0 0 0 5"
                           Foreground="{DynamicResource WindowForegroundColor}"
                           Text="Quick Access"
                           FontSize="15" />

                <Border Grid.Row="8"
                        Grid.Column="0"
                        CornerRadius="15">

                    -->
            <!--ItemsSource="{Binding DriveList}"-->
            <!--
                    <ListView Name="QuickAccessList"
                              BorderBrush="Transparent"
                              Background="Transparent"
                              HorizontalContentAlignment="Stretch"
                              ItemContainerStyle="{DynamicResource QuickAccessListViewItemStyle}"
                              ItemTemplate="{DynamicResource QuickAccessTemplateStyle}"
                              Grid.Row="2"
                              Grid.Column="0">

                    </ListView>
                </Border>

            </Grid>-->

            <Grid Grid.Column="1"
                  Margin="10 10 10 10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="50" />
                    <RowDefinition Height="60" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <Border Grid.Row="0"
                        BorderBrush="#6b6b6b"
                        BorderThickness="0 0 0 2">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="30" />
                        </Grid.ColumnDefinitions>

                        <!--Style="{StaticResource MultiplyBtnStyle}"-->
                        <Button Grid.Column="0" IsEnabled="{Binding IsBackNavigationEnabled,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                Style="{StaticResource backBtnStyle}" VerticalContentAlignment="Center" HorizontalContentAlignment="Center"
                                Command="{Binding BackWindowCommand}">
                            <Path Data="{StaticResource UpBackwardArrow}"
                                  Height="24"
                                  Width="24"
                                  Style="{DynamicResource IcnPathStyle}"
                                  Margin="0" Stretch="Uniform"
                                  Fill="#666666" />
                        </Button>

                        <!--<Grid >-->
                        <Path Grid.Column="1"
                              VerticalAlignment="Center"
                              Fill="{DynamicResource SecondaryWindowForegroundColor}"
                              Visibility="{Binding Offline,Converter={StaticResource BoolVisibilityInverseConverter}}"
                              Margin="10 0 0 0" Data="{StaticResource HeaderIcon}"/>
                        <!--</Grid>-->

                        <Grid Grid.Column="1"
                              Visibility="{Binding Offline,Converter={StaticResource BoolVisibilityConverter}}"
                              Margin="10 0 0 0">
                            <Path Style="{StaticResource IcnPathStyle}"
                                  Width="30"
                                  Height="25"
                                  Fill="#E6B6B4"
                                  Data="M895.5 660.5L742 239.7l-0.1-0.4c-6.5-17.1-18-31.6-33-42-15.1-10.4-32.7-15.9-51-15.9h-313c-39 0-73.3 24.9-85.5 61.9l-0.1 0.2L128.2 661c-10.8 18-17 39-17 61.5 0 66.2 53.8 120 120 120h561.6c66.2 0 120-53.8 120-120 0-22.7-6.3-43.9-17.3-62zM306.8 258.9c5.5-16.4 20.7-27.4 38-27.4h313c16.4 0 31.4 10.3 37.3 25.6l127.4 349.1c-9.5-2.4-19.4-3.7-29.7-3.7H231.2c-11.7 0-23.1 1.7-33.8 4.8l109.4-348.4z m486 533.6H231.2c-38.6 0-70-31.4-70-70s31.4-70 70-70h561.6c38.6 0 70 31.4 70 70s-31.4 70-70 70z" />
                            <!--<Path Style="{DynamicResource IcnPathStyle}"  Width="30" Data="M735 722m-34 0a34 34 0 1 0 68 0 34 34 0 1 0-68 0Z" />-->
                            <Path Style="{StaticResource IcnPathStyle}"
                                  Margin="0 -8 0 0"
                                  Width="10"
                                  Height="10"
                                  Fill="#E6B6B4"
                                  Data="M331 543.3c16.1 15.2 37.1 23.6 59.3 23.6h224.3c28 0 54.3-10.9 74.1-30.7 20.6-20.6 31.7-49.1 30.6-78.2-1-27.3-12.6-52.8-32.7-71.7-14.5-13.8-32.4-23-51.6-26.9-9.8-58.3-60.9-102.9-122.2-102.9h-20.3c-33 0-63.9 12.8-87.2 36.1-23.3 23.4-36.1 54.4-36.1 87.3 0 6.5 0.5 13 1.5 19.3-15.5 3.5-29.8 11.3-41.3 22.8-16.5 16.6-25.6 39.5-24.8 62.9 0.7 22.3 10.1 43 26.4 58.4z m33.8-85.9c6.6-6.6 15.4-10.2 24.7-10.2 11 0 21.5-5.3 28-14.2 6.5-8.9 8.4-20.5 5.1-31.1-2.2-7.1-3.4-14.5-3.4-22 0-19.6 7.6-38 21.5-51.9 13.8-13.9 32.2-21.5 51.9-21.5h20.3c40.8 0 73.9 32.9 73.9 73.3v0.4c0 7.2 2.7 14 7.8 19.1 5.1 5.1 11.8 7.9 19 7.9 14.5 0 28.2 5.5 38.7 15.4 10.4 9.9 16.5 23.1 17 37.3 0.6 15.5-5.1 30-16 40.9-10.4 10.4-24.1 16.1-38.8 16.1H390.3c-19.1 0-35.1-15.1-35.7-33.6-0.4-9.8 3.3-19 10.2-25.9z" />
                        </Grid>

                        <StackPanel Orientation="Horizontal"
                                    Grid.Column="2">
                            <TextBlock Text="CDM - IAM Cloud"
                                       Foreground="{DynamicResource WindowForegroundColor}"
                                       VerticalAlignment="Center"
                                       Margin="8 0 0 0"
                                       FontSize="20"></TextBlock>
                            <TextBlock Text="(CDM Error)"
                                       Visibility="{Binding Offline,Converter={StaticResource BoolVisibilityConverter}}"
                                       Foreground="#E6B6B4"
                                       VerticalAlignment="Center"
                                       Margin="8 0 0 0"
                                       FontSize="20"></TextBlock>
                            <TextBlock Text=">"
                                       Visibility="{Binding CurSearchStatus.Title,Converter={StaticResource EmptyStringVisibilityConverter}}"
                                       Foreground="{DynamicResource WindowForegroundColor}"
                                       VerticalAlignment="Center"
                                       Margin="8 0 0 0"
                                       FontSize="20"></TextBlock>
                            <TextBlock Text="{Binding CurSearchStatus.Title}"
                                       Visibility="{Binding CurSearchStatus.Title,Converter={StaticResource EmptyStringVisibilityConverter}}"
                                       Foreground="{DynamicResource WindowForegroundColor}"
                                       VerticalAlignment="Center"
                                       Margin="8 0 0 0"
                                       FontSize="20"></TextBlock>
                            <TextBlock Text="Loading..."
                                       Visibility="{Binding CurSearchStatus.IsLoading,Converter={StaticResource BoolVisibilityConverter},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                       Foreground="{DynamicResource WindowForegroundColor}"
                                       VerticalAlignment="Center"
                                       Margin="8 0 0 0"
                                       FontSize="16" FontWeight="Normal" ></TextBlock>
                        </StackPanel>


                        <Grid Grid.Column="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Grid Grid.Column="0"
                                  Visibility="{Binding CurFolder.Type, Converter={StaticResource DirFileTypeVisibilityConverter}}">
                                <Button x:Name="btnStar"
                                        ToolTip="Set this item as default"
                                        Command="{Binding StarCommand}"
                                        CommandParameter="{Binding CurFolder}"
                                        Visibility="{Binding CurFolder.IsDefault, Converter={StaticResource BoolVisibilityInverseConverter}}"
                                        BorderThickness="0"
                                        Margin="0 0 5 0" Style="{StaticResource PinButtonStyle}"
                                        Width="20" 
                                        Height="20">
                                    <Path Data="{StaticResource StarGeometry}"  Style="{StaticResource PinStarPathIconStyle}" />

                                </Button>
                                <Button x:Name="btnUnstar"
                                        ToolTip="Unset this item as default"
                                        Command="{Binding UnstarCommand}"
                                        CommandParameter="{Binding CurFolder}"
                                        Visibility="{Binding CurFolder.IsDefault, Converter={StaticResource BoolVisibilityConverter}}"
                                        BorderThickness="0"
                                        Margin="0 0 5 0"
                                        Width="20"  Style="{StaticResource PinButtonStyle}"
                                        Height="20">
                                    <Path Data="{StaticResource FilledStarGeometry}"  Style="{StaticResource PinStarPathIconStyle}" />
                                </Button>
                            </Grid>
                            <Grid Grid.Column="0"
                                  Visibility="Collapsed">
                                <Button x:Name="btnPin"
                                        ToolTip="Pin this item to the list"
                                        Command="{Binding PinCommand}"
                                        CommandParameter="{Binding CurFolder}"
                                        Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"
                                        Visibility="{Binding CurFolder.IsPined, Converter={StaticResource BoolVisibilityInverseConverter}}"
                                        BorderThickness="0"
                                        Margin="0 0 5 0"
                                        Width="20" Style="{StaticResource PinButtonStyle}"
                                        Height="20">
                                    <Path Data="{StaticResource PinGeometry}"  Style="{StaticResource PinStarPathIconStyle}" />

                                </Button>
                                <Button x:Name="btnUnpin"
                                        ToolTip="Unpin this item from the list"
                                        Command="{Binding UnpinCommand}"
                                        CommandParameter="{Binding CurFolder}"
                                        Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"
                                        Visibility="{Binding CurFolder.IsPined, Converter={StaticResource BoolVisibilityConverter}}"
                                        BorderThickness="0"
                                        Margin="0 0 5 0"
                                        Width="20" Style="{StaticResource PinButtonStyle}"
                                        Height="20">
                                    <Path Data="{StaticResource UnPinGeometry}"  Style="{StaticResource PinStarPathIconStyle}" />

                                </Button>
                            </Grid>
                        </Grid>
                    </Grid>
                </Border>

                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Border BorderBrush="{DynamicResource SeachBoxBorderColor}"
                                Background="{DynamicResource SeachBoxBackgroundColor}"
                                BorderThickness="1" MinWidth="600" MaxWidth="600"
                                CornerRadius="3"
                                Height="40" Grid.Column="0">

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <Grid>
                                <TextBlock Text="Search" 
             Visibility="{Binding IsSearchBoxPlaceholderVisible,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
             VerticalAlignment="Center" Margin="26 0 0 0" FontSize="16"
    Foreground="{DynamicResource SeachBoxPlaceHolderColor}" />
                                <!--Foreground="#444444"-->

                                <TextBox x:Name="txtSearchBox" 
                                    CaretBrush="Black" TextChanged="OnSearchTextChanged" PreviewKeyDown="txtSearchBox_PreviewKeyDown" PreviewKeyUp="txtSearchBox_PreviewKeyUp"
                                    IsEnabled="{Binding CurSearchStatus.CanSearch}"
                                    Text="{Binding TxtSearchBoxItem, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                    Style="{StaticResource txtSearchBoxStyle}">
                                    <i:Interaction.Triggers>

                                        <i:EventTrigger EventName="GotFocus">
                                            <i:InvokeCommandAction Command="{Binding TxtSearchGotFocusCommand}" />
                                        </i:EventTrigger>
                                        <i:EventTrigger EventName="LostFocus">
                                            <i:InvokeCommandAction Command="{Binding TxtSearchLostFocusCommand}" />
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                    <TextBox.InputBindings>
                                        <KeyBinding Key="Enter" Command="{Binding DoSearchCommand}" />
                                    </TextBox.InputBindings>
                                </TextBox>

                                <Popup Name="tipSearchError"
                                       IsOpen="{Binding CurSearchStatus.IsError}"
                                       PlacementTarget="{Binding ElementName=txtSearchBox}"
                                       Placement="Bottom"
                                       VerticalOffset="-1">
                                    <Border Margin="0 0 0 0"
                                      BorderThickness="1"
                                      BorderBrush="#6b6b6b"
                                      CornerRadius="3"
                                      Width="400"
                                      Height="30"
                                      VerticalAlignment="Stretch"
                                      HorizontalAlignment="Stretch"
                                      Background="{DynamicResource WindowBackgroundColor}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"></ColumnDefinition>
                                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock VerticalAlignment="Center"
                                               Text="{Binding CurSearchStatus.Desc}"
                                               Grid.Column="0"
                                               Name="txtSearchError"
                                               Foreground="#E6B6B4"
                                               Padding="5">
                                            </TextBlock>
                                            <Button Grid.Column="1"
                                                   Command="{Binding ClearSearchErrorCommand}"
                                                   Background="Transparent" BorderThickness="1" Cursor="Hand"
                                                   Foreground="{DynamicResource WindowForegroundColor}">
                                                <Button.Template>
                                                    <ControlTemplate>
                                                        <TextBlock VerticalAlignment="Center"
                                                                Text="×" FontSize="20" FontWeight="Thin">
                                                        </TextBlock>
                                                    </ControlTemplate>
                                                </Button.Template>
                                            </Button>
                                        </Grid>
                                    </Border>
                                </Popup>
                            </Grid>

                            <StackPanel Grid.Column="1" Orientation="Horizontal" Width="Auto" Margin="5 0" >

                                <Button IsEnabled="{Binding CurSearchStatus.CanSearch}"
                                           Command="{Binding ClearSearchCommand}" HorizontalAlignment="Right"  Style="{StaticResource btnSearch}"
                                           Visibility="{Binding TxtSearchBoxItem, Converter={StaticResource EmptyStringVisibilityConverter}}" >
                                    <Button.Template>
                                        <ControlTemplate>
                                            <Path Stretch="Uniform" Stroke="#1C1C1C" Fill="#1C1C1C" Height="12"
                                                    Data="{StaticResource CloseGeometry}" />
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>

                                <Button x:Name="purchasedBookSearchBtn"  Visibility="{Binding IsDriveWindowVisible}"
                                       IsEnabled="{Binding CurSearchStatus.CanSearch}"  HorizontalAlignment="Right"
                                       Command="{Binding DoSearchCommand}"
                                       Style="{StaticResource btnSearch}">

                                    <Path Data="{StaticResource SearchGlassGeometry}"
                      Stretch="Uniform"
                      Height="14" Fill="#1C1C1C" Stroke="#1C1C1C"/>
                                </Button>

                                <Button IsEnabled="{Binding CurSearchStatus.CanSearch}"  HorizontalAlignment="Right"
                                    Command="{Binding DoSearchCommand}"  Visibility="{Binding IsDriveFoldersVisible}"
                                    Style="{StaticResource btnSearch}" >

                                    <Path Data="{StaticResource SearchGlassGeometry}"
                                      Stretch="Uniform"
                                      Height="14" Fill="#1C1C1C" Stroke="#1C1C1C"/>
                                </Button>

                                <Grid  Visibility="{Binding IsDriveFoldersVisible,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Right">
                                    <Button IsEnabled="{Binding CurSearchStatus.CanSearch}"
                                          Command="{Binding ShowLocationsCommand}"
                                          Cursor="Hand" 
                                          Style="{StaticResource btnSearch}">
                                        <Button.Template>
                                            <ControlTemplate>
                                                <Border >
                                                    <Grid VerticalAlignment="Center" HorizontalAlignment="Center" >
                                                        <Path  Visibility="{Binding CurFilterStatus.ShowLocations, Converter={StaticResource BoolVisibilityInverseConverter}}"
                                                               Data="{StaticResource DownArrowGeometry}" Fill="#1C1C1C" Height="10" Stretch="Uniform" />

                                                        <Path Visibility="{Binding CurFilterStatus.ShowLocations, Converter={StaticResource BoolVisibilityConverter}}"
                                                            Data="{StaticResource UpArrowGeometry}" Fill="#1C1C1C"/>
                                                    </Grid>
                                                </Border>
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>
                                    <!--<Button Name="btnLocations"
                                                 IsEnabled="{Binding CurSearchStatus.CanSearch}"
                                                 
                                                 Command="{Binding ShowLocationsCommand}"
                                                 Background="Transparent"
                                                 VerticalAlignment="Center"
                                                 HorizontalAlignment="Center"
                                                 BorderThickness="1"
                                                 Cursor="Hand"
                                                 Style="{StaticResource btnSearch}"
                                                 Foreground="{DynamicResource WindowForegroundColor}">
                                        <Button.Template>
                                            <ControlTemplate>
                                               
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>-->
                                    <Popup Name="popupLocations"
                                         IsOpen="{Binding CurFilterStatus.ShowLocations}"
                                         PlacementTarget="{Binding ElementName=btnLocations}"
                                         Placement="Bottom"
                                         VerticalOffset="-1">
                                        <Border Margin="0 0 0 0"
                                           BorderThickness="0"
                                           BorderBrush="#6b6b6b"
                                           CornerRadius="3"
                                           Width="130"
                                           Height="Auto"
                                           VerticalAlignment="Stretch"
                                           HorizontalAlignment="Stretch">
                                            <ListView SelectionMode="Single"
                                                    FontSize="16"
                                                    ItemsSource="{Binding Locations}"
                                                    SelectedItem="{Binding SelectedLocation,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                    Background="{DynamicResource WindowBackgroundColor}">
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Foreground="{DynamicResource WindowForegroundColor}"
                                                              VerticalAlignment="Center"
                                                              Text="{Binding Name}"></TextBlock>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </Border>
                                    </Popup>
                                </Grid>

                            </StackPanel>
                        </Grid>
                    </Border>

                    <StackPanel Orientation="Horizontal"
                                Grid.Column="1">
                        <TextBlock Text="Searching..."
                                   Margin="5,0,0,0"
                                   VerticalAlignment="Center"
                                       FontSize="16" FontWeight="Normal" 
                                   Visibility="{Binding CurSearchStatus.IsDoing, Converter={StaticResource BoolVisibilityConverter},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                   Foreground="{DynamicResource WindowForegroundColor}">
                        </TextBlock>
                        <Button Margin="5,0,0,0"
                                Visibility="{Binding CurSearchStatus.IsDoing, Converter={StaticResource BoolVisibilityConverter},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                Command="{Binding CancelSearchCommand}"
                                Background="Transparent"
                                VerticalAlignment="Center"
                                BorderThickness="0"
                                Cursor="Hand"
                                Foreground="{DynamicResource WindowForegroundColor}">
                            <Button.Template>
                                <ControlTemplate>
                                    <TextBlock VerticalAlignment="Center"
                                               Text="Cancel"
                                       FontSize="16" FontWeight="Normal" 
                                               Foreground="#A0B8EC">
                                    </TextBlock>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>
                </Grid>

                <!--Mainwindow-->
                <Grid Grid.Row="2"
                      Name="DriveWindow"
                      Visibility="{Binding IsDriveWindowVisible}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="36" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <!--Visibility="{Binding IsAvailableBooksVisibility}"-->
                    <Border Grid.Row="0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"></RowDefinition>
                                <RowDefinition Height="Auto"></RowDefinition>
                            </Grid.RowDefinitions>
                            <TextBlock Margin="0,0,0,10"
                                       Grid.Row="0"
                                       Text="We didn't find anything to show here."
                                       FontWeight="Thin"
                                       FontSize="14"
                                       Visibility="{Binding CurFilterStatus.DrivesCount, Converter={StaticResource ZeroIntVisibilityInverseConverter}}"
                                       Foreground="{DynamicResource WindowForegroundColor}">
                            </TextBlock>
                            <!--Style="{StaticResource BookListViewStyle}"-->
                            <ListView ItemTemplate="{StaticResource DriveTemplateStyle}"
                                      Grid.Row="0"
                                      ItemsSource="{Binding PagedDrivesList,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                      ItemContainerStyle="{StaticResource driveListViewItemStyle}"
                                      VerticalAlignment="Top"
                                      BorderBrush="Transparent"
                                      ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                                      SelectedItem="{Binding DriveSelectedItem, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                      Background="Transparent"
                                      SelectionMode="Single">

                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="MouseLeftButtonUp">
                                        <i:InvokeCommandAction Command="{Binding DoubleClickCommand, Mode=TwoWay}"
                               CommandParameter="{Binding SelectedItem, RelativeSource={RelativeSource AncestorType=ListView}}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>

                                <ListView.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Height="Auto"
                                                   Margin="0" />
                                        <!--<UniformGrid Columns="4"
                                                 VerticalAlignment="Top"
                                                 HorizontalAlignment="Stretch" />-->
                                    </ItemsPanelTemplate>
                                </ListView.ItemsPanel>
                            </ListView>
                            <!--<Image gif:ImageBehavior.AnimatedSource="/CDM;component/Resources/loading.gif"
                                   Grid.Row="1" HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Visibility="{Binding CurSearchStatus.IsLoadingDrives,Converter={StaticResource BoolVisibilityConverter}}"
                                   Width="40" Height="8" Margin="0,10,0,10" />-->
                        </Grid>
                    </Border>

                    <StackPanel Grid.Row="1"
                                Height="36"
                                Orientation="Horizontal"
                                HorizontalAlignment="Right">
                        <Button x:Name="Left"
                                Command="{Binding PrevDrivesCommand}"
                                Visibility="{Binding IsFirstDrivesPage,Converter={StaticResource BoolVisibilityInverseConverter}}"
                                Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"
                                BorderThickness="0"
                                Margin="0 0 5 0"
                                Width="36"
                                Height="36">
                            <Path Data="M297.813333 491.648l1.365334-1.749333 379.093333-376.149334a38.784 38.784 0 0 1 5.077333-4.096 34.346667 34.346667 0 0 1 14.293334-4.992c2.218667-0.170667 2.176-0.170667 4.394666-0.170666a33.493333 33.493333 0 0 1 14.549334 4.181333c12.330667 6.997333 18.688 21.76 15.274666 35.498667-1.237333 5.077333-7.04 13.44-7.04 13.44l-355.498666 352.853333 354.090666 354.389333s6.272 7.978667 7.893334 12.928a32.213333 32.213333 0 0 1-33.749334 41.557334c-6.656-0.682667-17.749333-7.68-17.749333-7.68l-379.221333-377.984-1.28-1.450667a30.378667 30.378667 0 0 1-7.893334-17.749333 31.018667 31.018667 0 0 1 3.712-18.602667 27.221333 27.221333 0 0 1 2.688-4.224z"
                                  Fill="{DynamicResource DriveNavigationBtnIcnPath}"
                                  Height="20"
                                  Width="20"
                                  Stretch="Uniform" />
                        </Button>
                        <!--Content="&lt;"-->

                        <!--Content="&gt;"-->
                        <Button x:Name="Right"
                                Command="{Binding NextDrivesCommand}"
                                Visibility="{Binding IsLastDrivesPage,Converter={StaticResource BoolVisibilityInverseConverter}}"
                                Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"
                                BorderThickness="0"
                                Width="36"
                                Height="36">
                            <Path Data="M290.909091 983.272727a29.090909 29.090909 0 0 1-20.596364-49.570909L689.92 512l-418.909091-421.701818a29.090909 29.090909 0 0 1 41.309091-40.96l439.505455 442.181818a29.090909 29.090909 0 0 1 0 40.96l-439.505455 442.181818a28.974545 28.974545 0 0 1-21.410909 8.610909z"
                                  Fill="{DynamicResource DriveNavigationBtnIcnPath}"
                                  Height="20"
                                  Width="20"
                                  Stretch="Uniform" />
                        </Button>

                    </StackPanel>

                    <Border Grid.Row="2"
                            BorderBrush="Transparent"
                            Background="Transparent">

                        <TabControl BorderThickness="0" x:Name="TabView1"
                                    Background="Transparent">
                            <TabControl.Resources>

                            </TabControl.Resources>

                            <TabItem Name="RecentTabItem"
                                     Style="{StaticResource TabItemStyle}"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                                     Header="Recent">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"></RowDefinition>
                                        <RowDefinition Height="Auto"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <TextBlock Margin="20,10,0,0"
                                               Grid.Row="0"
                                               Text="We didn't find anything to show here."
                                               FontWeight="Thin"
                                               FontSize="14"
                                               Visibility="{Binding CurFilterStatus.RecentCount, Converter={StaticResource ZeroIntVisibilityInverseConverter}}"
                                               Foreground="{DynamicResource WindowForegroundColor}">
                                    </TextBlock>
                                    <DataGrid x:Name="ListOfRecentItems"
                                              Grid.Row="0"
                                              AllowDrop="True"
                                              Visibility="{Binding CurFilterStatus.RecentCount, Converter={StaticResource ZeroIntVisibilityConverter}}"
                                              ItemsSource="{Binding RecentItemList}"
                                              SelectedItem="{Binding SelectedRecentItem}"
                                              ColumnHeaderStyle="{StaticResource DGHeaderStyle}"
                                              RowStyle="{StaticResource DGRowStyle}"
                                              CellStyle="{StaticResource DGCellStyle}"
                                              Style="{StaticResource DGStyle}"
                                              SelectionMode="Single"
                                              SelectionUnit="FullRow">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="MouseLeftButtonUp">
                                                <i:InvokeCommandAction Command="{Binding RecentItemDoubleClickCommand}" CommandParameter="{Binding SelectedItem, RelativeSource={RelativeSource AncestorType=DataGrid}}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>

                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn MinWidth="80"
                                                                    Width="auto">
                                                <DataGridTemplateColumn.Header>
                                                    <Grid Margin="23 0 0 0" HorizontalAlignment="Center">
                                                        <Path Stretch="None" Height="16" Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGHeaderFile1of6Geometry}"/>
                                                        <Path Stretch="None" Height="16" Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGHeaderFile2of6Geometry}"/>
                                                        <Path Stretch="None" Height="16" Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGHeaderFile3of6Geometry}"/>
                                                        <Path Stretch="None" Height="16" Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGHeaderFile4of6Geometry}"/>
                                                        <Path Stretch="None" Height="16" Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGHeaderFile5of6Geometry}"/>
                                                        <Path Stretch="None" Height="16" Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGHeaderFile6of6Geometry}"/>
                                                    </Grid>
                                                </DataGridTemplateColumn.Header>

                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Image Width="40"
                                                               Height="30"
                                                               Margin="0 0 5 0"
                                                               Source="{Binding IconSource}"
                                                               HorizontalAlignment="Center" />

                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>

                                            <DataGridTextColumn Width="*"
                                                                MinWidth="250"
                                                                Header="Name"
                                                                ElementStyle="{StaticResource Centering}"
                                                                Binding="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                            <DataGridTemplateColumn MinWidth="80"
                                                                    Width="auto">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition></ColumnDefinition>
                                                                <ColumnDefinition></ColumnDefinition>
                                                                <ColumnDefinition></ColumnDefinition>

                                                            </Grid.ColumnDefinitions>

                                                            <Button Grid.Column="0" Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=UserControl}, Path=DataContext.GoToParentCommand}"
                                                                      CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=DataContext}"
                                                                      ToolTip="Go to parent" Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"  
                                                                    BorderThickness="0" Margin="0 0 5 0" Width="30" Height="30">
                                                                <Button.Style>
                                                                    <Style  TargetType="Button" BasedOn="{StaticResource PinButtonStyle}">
                                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                                        <Style.Triggers>
                                                                            <MultiDataTrigger >
                                                                                <MultiDataTrigger.Conditions>
                                                                                    <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsMouseOver}" Value="True" />
                                                                                </MultiDataTrigger.Conditions>
                                                                                <Setter Property="Visibility" Value="Visible"/>
                                                                            </MultiDataTrigger>
                                                                            <MultiDataTrigger >
                                                                                <MultiDataTrigger.Conditions>
                                                                                    <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected}" Value="True" />
                                                                                </MultiDataTrigger.Conditions>
                                                                                <Setter Property="Visibility" Value="Visible"/>
                                                                            </MultiDataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </Button.Style>
                                                                <Grid>
                                                                    <Grid.Resources>
                                                                        <Style TargetType="Path">
                                                                            <Setter Property="Fill" Value="{DynamicResource SecondaryWindowForegroundColor}"/>
                                                                        </Style>
                                                                    </Grid.Resources>
                                                                    <Path Data="{StaticResource GoToParent1of5Geometry}" />
                                                                    <Path Data="{StaticResource GoToParent2of5Geometry}" />
                                                                    <Path Data="{StaticResource GoToParent3of5Geometry}" />
                                                                    <Path Data="{StaticResource GoToParent4of5Geometry}" />
                                                                    <Path Data="{StaticResource GoToParent5of5Geometry}" />
                                                                </Grid>
                                                            </Button>

                                                            <Grid Grid.Column="1"
                                                                  Visibility="{Binding Type, Converter={StaticResource DirFileTypeVisibilityConverter}}">
                                                                <Button x:Name="btnStar"
                                                                        ToolTip="Set this item as default"
                                                                        Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=UserControl}, Path=DataContext.StarCommand}"
                                                                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=DataContext}"
                                                                        Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"
                                                                        BorderThickness="0" Margin="0 0 5 0" Width="20" Height="20">
                                                                    <Button.Style>
                                                                        <Style  TargetType="Button" BasedOn="{StaticResource PinButtonStyle}">
                                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                                            <Style.Triggers>
                                                                                <MultiDataTrigger >
                                                                                    <MultiDataTrigger.Conditions>
                                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsMouseOver}" Value="True" />
                                                                                        <Condition Binding="{Binding IsDefault}" Value="False" />
                                                                                    </MultiDataTrigger.Conditions>
                                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                                </MultiDataTrigger>
                                                                                <MultiDataTrigger >
                                                                                    <MultiDataTrigger.Conditions>
                                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected}" Value="True" />
                                                                                        <Condition Binding="{Binding IsDefault}" Value="False" />
                                                                                    </MultiDataTrigger.Conditions>
                                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                                </MultiDataTrigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </Button.Style>
                                                                    <Path Data="{StaticResource StarGeometry}" Style="{StaticResource PinStarPathIconStyle}" />
                                                                </Button>
                                                                <Button x:Name="btnUnstar"
                                                                        ToolTip="Unset this item as default"
                                                                        Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=UserControl}, Path=DataContext.UnstarCommand}"
                                                                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=DataContext}"
                                                                        Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"
                                                                        Visibility="{Binding IsDefault, Converter={StaticResource BoolVisibilityConverter}}"
                                                                        BorderThickness="0"
                                                                        Margin="0 0 5 0"
                                                                        Width="20" Style="{StaticResource PinButtonStyle}"
                                                                        Height="20">
                                                                    <Path Data="{StaticResource FilledStarGeometry}" Style="{StaticResource PinStarPathIconStyle}"  />

                                                                </Button>
                                                            </Grid>

                                                            <Grid Grid.Column="2">
                                                                <Button x:Name="btnPin"
                                                                        ToolTip="Pin this item to the list"
                                                                        Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=UserControl}, Path=DataContext.PinCommand}"
                                                                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=DataContext}"
                                                                        Background="Transparent"
                                                                        BorderThickness="0"
                                                                         Margin="5 5 0 5" Width="30" Height="30">
                                                                    <Button.Style>
                                                                        <Style  TargetType="Button" BasedOn="{StaticResource PinButtonStyle}">
                                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                                            <Style.Triggers>
                                                                                <MultiDataTrigger >
                                                                                    <MultiDataTrigger.Conditions>
                                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsMouseOver}" Value="True" />
                                                                                        <Condition Binding="{Binding IsPined}" Value="False" />
                                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.IsPinLimitReached}" Value="False" />
                                                                                    </MultiDataTrigger.Conditions>
                                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                                </MultiDataTrigger>
                                                                                <MultiDataTrigger >
                                                                                    <MultiDataTrigger.Conditions>
                                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected}" Value="True" />
                                                                                        <Condition Binding="{Binding IsPined}" Value="False" />
                                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.IsPinLimitReached}" Value="False" />
                                                                                    </MultiDataTrigger.Conditions>
                                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                                </MultiDataTrigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </Button.Style>
                                                                    <Path Data="{StaticResource PinGeometry}" Style="{StaticResource PinStarPathIconStyle}"  />

                                                                </Button>
                                                                <Button x:Name="btnUnpin"
                                                                        ToolTip="Unpin this item from the list"
                                                                        Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=UserControl}, Path=DataContext.UnpinCommand}"
                                                                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=DataContext}"
                                                                        Background="{Binding Transparent}"
                                                                        Visibility="{Binding IsPined, Converter={StaticResource BoolVisibilityConverter}}"
                                                                        BorderThickness="0"
                                                                        Margin="5 5 0 5"
                                                                        Width="30" Style="{StaticResource PinButtonStyle}"
                                                                        Height="30">
                                                                    <Path Data="{StaticResource UnPinGeometry}" Style="{StaticResource PinStarPathIconStyle}"  />
                                                                </Button>
                                                            </Grid>

                                                        </Grid>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>

                                            <DataGridTextColumn Width="Auto"
                                                                MinWidth="250" 
                                                                Header="Date modified"
                                                                ElementStyle="{StaticResource Centering}"
                                                                Binding="{Binding LastModifiedDateTime, Converter={StaticResource DateTimeConverter}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }" />
                                        </DataGrid.Columns>
                                        <DataGrid.ContextMenu>
                                            <ContextMenu StaysOpen="False">

                                                <MenuItem 
                                                          Command="{Binding OpenItemCommand}"
                                                          CommandParameter="{Binding Path=PlacementTarget.SelectedItem, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                                          Height="35" >
                                                    <MenuItem.Header>
                                                        <AccessText Text="Open" />
                                                    </MenuItem.Header>
                                                </MenuItem>
                                                <MenuItem 
                                                          Command="{Binding CopyItemPathCommand}"
                                                          CommandParameter="{Binding Path=PlacementTarget.SelectedItem, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                                          Height="35" >
                                                    <MenuItem.Header>
                                                        <AccessText Text="_Copy path to clipboard" />
                                                    </MenuItem.Header>
                                                </MenuItem>
                                                <MenuItem 
                                                          Command="{Binding RenameItemCommand}"
                                                          CommandParameter="{Binding Path=PlacementTarget.SelectedItem, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                                          Height="35" >
                                                    <MenuItem.Header>
                                                        <AccessText Text="_Rename" />
                                                    </MenuItem.Header>
                                                </MenuItem>
                                                <MenuItem 
                                                          Command="{Binding DeleteItemCommand}"
                                                          CommandParameter="{Binding Path=PlacementTarget.SelectedItem, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                                          Height="35" >
                                                    <MenuItem.Header>
                                                        <AccessText Text="_Delete" />
                                                    </MenuItem.Header>
                                                </MenuItem>
                                            </ContextMenu>
                                        </DataGrid.ContextMenu>
                                    </DataGrid>
                                    <!--<Image gif:ImageBehavior.AnimatedSource="/CDM;component/Resources/loading.gif"
                                       Grid.Row="1" HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Visibility="{Binding CurSearchStatus.IsLoadingRecent,Converter={StaticResource BoolVisibilityConverter}}"
                                       Width="40" Height="8" Margin="0,10,0,10" />-->
                                </Grid>
                            </TabItem>

                            <TabItem Name="PinnedTabItem"
                                     Style="{StaticResource TabItemStyle}"
                                     Header="Pinned">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"></RowDefinition>
                                        <RowDefinition Height="*"></RowDefinition>
                                        <RowDefinition Height="Auto"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <TextBlock Margin="20,10,0,0"
                                               Grid.Row="0"
                                               Text="We didn't find anything to show here."
                                               FontWeight="Thin"
                                               FontSize="14"
                                               Visibility="{Binding CurFilterStatus.PinnedCount, Converter={StaticResource ZeroIntVisibilityInverseConverter}}"
                                               Foreground="{DynamicResource WindowForegroundColor}">
                                    </TextBlock>
                                    <DataGrid x:Name="ListOfPinnedItems"
                                              AllowDrop="True"
                                              Visibility="{Binding CurFilterStatus.PinnedCount, Converter={StaticResource ZeroIntVisibilityConverter}}"
                                              Grid.Row="1"
                                              ItemsSource="{Binding PinnedItemList}"
                                              SelectedItem="{Binding SelectedPinnedItem}"
                                              ColumnHeaderStyle="{StaticResource DGHeaderStyle}"
                                              RowStyle="{StaticResource DGRowStyle}"
                                              CellStyle="{StaticResource DGCellStyle}"
                                              Style="{StaticResource DGStyle}"
                                              SelectionMode="Single"
                                              SelectionUnit="FullRow">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="MouseDoubleClick">
                                                <i:InvokeCommandAction Command="{Binding PinnedItemDoubleClickCommand}"
                                                                       CommandParameter="{Binding ElementName=ListOfPinnedItems, Path=SelectedItem}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>

                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn MinWidth="80"
                                                                    Width="auto">
                                                <DataGridTemplateColumn.Header>
                                                    <Grid>
                                                        <Path Margin="20 0"
                                                              Height="20"
                                                              Width="20"
                                                              Style="{StaticResource IcnPathStyle}"
                                                              Data="M491.683,213.34H470.35v-64c0-11.782-9.551-21.333-21.333-21.333H406.35V21.34c0-11.782-9.551-21.333-21.333-21.333
H107.683c-11.782,0-21.333,9.551-21.333,21.333v42.667h-64c-11.782,0-21.333,9.551-21.333,21.333v404.74
c-0.028,0.943,0.001,1.878,0.097,2.8c0,0.004,0.001,0.008,0.001,0.012c0.045,0.426,0.102,0.849,0.172,1.269
c1.206,8.272,6.649,13.9,13.286,16.394c0.103,0.04,0.208,0.078,0.312,0.117c0.26,0.093,0.517,0.189,0.78,0.273
c1.035,0.339,2.109,0.598,3.215,0.777c0.043,0.007,0.086,0.013,0.13,0.02c0.451,0.07,0.908,0.126,1.37,0.168
c0.179,0.017,0.357,0.036,0.536,0.049c0.129,0.008,0.26,0.011,0.389,0.017c0.586,0.033,1.172,0.044,1.758,0.032H406.35
c9.182,0,17.335-5.876,20.239-14.587l85.333-256C516.526,227.605,506.244,213.34,491.683,213.34z M427.683,170.673v42.667H406.35
v-42.667H427.683z M129.016,42.673h234.667V149.34v64H129.016v-128V42.673z M43.683,106.673H86.35v124.538l-42.667,128V106.673z
 M390.974,469.34H51.948l34.533-103.6l36.578-109.733h261.957h64h13.068L390.974,469.34z" />
                                                    </Grid>
                                                </DataGridTemplateColumn.Header>
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Image Width="40"
                                                               Height="30"
                                                               Margin="0 0 5 0"
                                                               Source="{Binding IconSource}"
                                                               HorizontalAlignment="Center" />
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>

                                            <DataGridTextColumn Width="*"
                                                                MinWidth="250"
                                                                Header="Name"
                                                                ElementStyle="{StaticResource Centering}"
                                                                Binding="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                            <DataGridTemplateColumn MinWidth="80"
                                                                    Width="auto">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition></ColumnDefinition>
                                                                <ColumnDefinition></ColumnDefinition>
                                                            </Grid.ColumnDefinitions>
                                                            <Grid Grid.Column="0"
                                                                  Visibility="{Binding Type, Converter={StaticResource DirFileTypeVisibilityConverter}}">
                                                                <Button x:Name="btnStar"
                                                                        ToolTip="Set this item as default"
                                                                        Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=UserControl}, Path=DataContext.StarCommand}"
                                                                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=DataContext}"
                                                                        Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"
                                                                        BorderThickness="0"
                                                                        Margin="0 0 5 0"
                                                                        Width="30"
                                                                        Height="30">
                                                                    <Button.Style>
                                                                        <Style  TargetType="Button" BasedOn="{StaticResource PinButtonStyle}">
                                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                                            <Style.Triggers>
                                                                                <MultiDataTrigger >
                                                                                    <MultiDataTrigger.Conditions>
                                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsMouseOver}" Value="True" />
                                                                                        <Condition Binding="{Binding IsDefault}" Value="False" />
                                                                                    </MultiDataTrigger.Conditions>
                                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                                </MultiDataTrigger>
                                                                                <MultiDataTrigger >
                                                                                    <MultiDataTrigger.Conditions>
                                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected}" Value="True" />
                                                                                        <Condition Binding="{Binding IsDefault}" Value="False" />
                                                                                    </MultiDataTrigger.Conditions>
                                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                                </MultiDataTrigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </Button.Style>
                                                                    <Path Data="{StaticResource StarGeometry}" Style="{StaticResource PinStarPathIconStyle}" />

                                                                </Button>
                                                                <Button x:Name="btnUnstar"
                                                                        ToolTip="Unset this item as default"
                                                                        Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=UserControl}, Path=DataContext.UnstarCommand}"
                                                                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=DataContext}"
                                                                        Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"
                                                                        Visibility="{Binding IsDefault, Converter={StaticResource BoolVisibilityConverter}}"
                                                                        BorderThickness="0"
                                                                        Margin="0 0 5 0"
                                                                        Width="30" Style="{StaticResource PinButtonStyle}"
                                                                        Height="30">
                                                                    <Path Data="{StaticResource FilledStarGeometry}" Style="{StaticResource PinStarPathIconStyle}" />

                                                                </Button>
                                                            </Grid>
                                                            <Grid Grid.Column="1">
                                                                <Button x:Name="btnPin"
                                                                        ToolTip="Pin this item to the list"
                                                                        Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=UserControl}, Path=DataContext.PinCommand}"
                                                                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=DataContext}"
                                                                        Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"
                                                                        BorderThickness="0"
                                                                        Margin="0 0 5 0"
                                                                        Width="30"
                                                                        Height="30">
                                                                    <Button.Style>
                                                                        <Style  TargetType="Button" BasedOn="{StaticResource PinButtonStyle}">
                                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                                            <Style.Triggers>
                                                                                <MultiDataTrigger >
                                                                                    <MultiDataTrigger.Conditions>
                                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsMouseOver}" Value="True" />
                                                                                        <Condition Binding="{Binding IsPined}" Value="False" />
                                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.IsPinLimitReached}" Value="False" />
                                                                                    </MultiDataTrigger.Conditions>
                                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                                </MultiDataTrigger>
                                                                                <MultiDataTrigger >
                                                                                    <MultiDataTrigger.Conditions>
                                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected}" Value="True" />
                                                                                        <Condition Binding="{Binding IsPined}" Value="False" />
                                                                                        <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.IsPinLimitReached}" Value="False" />
                                                                                    </MultiDataTrigger.Conditions>
                                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                                </MultiDataTrigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </Button.Style>
                                                                    <Path Data="{StaticResource PinGeometry}" Style="{StaticResource PinStarPathIconStyle}"  />

                                                                </Button>
                                                                <Button x:Name="btnUnpin"
                                                                        ToolTip="Unpin this item from the list"
                                                                        Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=UserControl}, Path=DataContext.UnpinCommand}"
                                                                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=DataContext}"
                                                                        Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"
                                                                        Visibility="{Binding IsPined, Converter={StaticResource BoolVisibilityConverter}}"
                                                                        BorderThickness="0"
                                                                        Margin="0 0 5 0"
                                                                        Width="30" Style="{StaticResource PinButtonStyle}"
                                                                        Height="30">
                                                                    <Path Data="{StaticResource UnPinGeometry}" Style="{StaticResource PinStarPathIconStyle}"  />
                                                                </Button>
                                                            </Grid>
                                                        </Grid>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>

                                            <DataGridTextColumn Width="Auto"
                                                                MinWidth="250"
                                                                Header="Date modified"
                                                                ElementStyle="{StaticResource Centering}"
                                                                Binding="{Binding LastModifiedDateTime,Converter={StaticResource DateTimeConverter}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        </DataGrid.Columns>
                                        <DataGrid.ContextMenu>
                                            <ContextMenu StaysOpen="False">
                                                <MenuItem Header="Open"
                                                          Command="{Binding OpenItemCommand}"
                                                          CommandParameter="{Binding Path=PlacementTarget.SelectedItem, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                                          Height="35" />
                                                <MenuItem Header="Copy path to clipboard"
                                                          Command="{Binding CopyItemPathCommand}"
                                                          CommandParameter="{Binding Path=PlacementTarget.SelectedItem, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                                          Height="35" />
                                                <MenuItem Header="Rename"
                                                          Command="{Binding RenameItemCommand}"
                                                          CommandParameter="{Binding Path=PlacementTarget.SelectedItem, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                                          Height="35" />
                                                <MenuItem Header="Delete"
                                                          Command="{Binding DeleteItemCommand}"
                                                          CommandParameter="{Binding Path=PlacementTarget.SelectedItem, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                                          Height="35" />
                                            </ContextMenu>
                                        </DataGrid.ContextMenu>
                                    </DataGrid>
                                    <!--<Image gif:ImageBehavior.AnimatedSource="/CDM;component/Resources/loading.gif"
                                       Grid.Row="2" HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Visibility="{Binding CurSearchStatus.IsLoadingPinned,Converter={StaticResource BoolVisibilityConverter}}"
                                       Width="40" Height="8" Margin="0,10,0,10" />-->
                                </Grid>
                            </TabItem>
                        </TabControl>
                    </Border>
                </Grid>

                <!--Second Windows-->
                <Grid Grid.Row="2"
                      Name="DriveFoldersWindow"
                      Visibility="{Binding IsDriveFoldersVisible}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"></RowDefinition>
                        <RowDefinition Height="Auto"></RowDefinition>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="Auto"></RowDefinition>
                    </Grid.RowDefinitions>

                    <Border BorderBrush="{StaticResource LineColor}"
                            BorderThickness="0 1 0 1"
                            Grid.Row="0"
                            Visibility="{Binding CurSearchStatus.Searched, Converter={StaticResource BoolVisibilityConverter}}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="0">
                                <TextBlock VerticalAlignment="Center"
                                           FontSize="16" FontFamily="Segoe UI"
                                           FontWeight="Normal"
                                           Text="Results for: " 
                                           Foreground="{DynamicResource SecondaryWindowForegroundColor}"></TextBlock>
                                <Button x:Name="btnSearchFlag"
                                        Cursor="Arrow"
                                        Foreground="#A0B8EC"
                                        FontSize="16"
                                        FontWeight="Bold"
                                        Width="30" VerticalAlignment="Center"
                                        Style="{StaticResource btnSearch}">
                                    <Path Data="{StaticResource SearchGlassGeometry}"
                                          Stretch="Uniform"
                                          Height="14" Fill="#A0B8EC" Stroke="#A0B8EC"/>
                                </Button>
                                <TextBlock MaxWidth="500"
                                           VerticalAlignment="Center"
                                           FontSize="16"
                                           Text="{Binding TxtSearchBoxItem}"
                                           FontWeight="Bold"
                                           Foreground="#A0B8EC" Margin="0 0 10 0"
                                           ToolTip="{Binding TxtSearchBoxItem}"></TextBlock>
                                <Button Command="{Binding ClearSearchCommand}"
                                        Background="Transparent"
                                        FontSize="16"
                                        BorderThickness="1"
                                        Cursor="Hand"
                                        Margin="5,0,5,0" VerticalAlignment="Center"
                                        Foreground="{DynamicResource WindowForegroundColor}">
                                    <Button.Template>
                                        <ControlTemplate>
                                            <Grid VerticalAlignment="Center" HorizontalAlignment="Center">
                                                <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" 
                                                      Data="M5 5.70801L0.854492 9.85352C0.756836 9.95117 0.639648 10 0.50293 10C0.359701 10 0.239258 9.9528 0.141602 9.8584C0.0472005 9.76074 0 9.6403 0 9.49707C0 9.36035 0.0488281 9.24316 0.146484 9.14551L4.29199 5L0.146484 0.854492C0.0488281 0.756836 0 0.638021 0 0.498047C0 0.429688 0.0130208 0.364583 0.0390625 0.302734C0.0651042 0.240885 0.100911 0.188802 0.146484 0.146484C0.192057 0.100911 0.245768 0.0651042 0.307617 0.0390625C0.369466 0.0130208 0.43457 0 0.50293 0C0.639648 0 0.756836 0.0488281 0.854492 0.146484L5 4.29199L9.14551 0.146484C9.24316 0.0488281 9.36198 0 9.50195 0C9.57031 0 9.63379 0.0130208 9.69238 0.0390625C9.75423 0.0651042 9.80794 0.100911 9.85352 0.146484C9.89909 0.192057 9.9349 0.245768 9.96094 0.307617C9.98698 0.366211 10 0.429688 10 0.498047C10 0.638021 9.95117 0.756836 9.85352 0.854492L5.70801 5L9.85352 9.14551C9.95117 9.24316 10 9.36035 10 9.49707C10 9.56543 9.98698 9.63053 9.96094 9.69238C9.9349 9.75423 9.89909 9.80794 9.85352 9.85352C9.8112 9.89909 9.75911 9.9349 9.69727 9.96094C9.63542 9.98698 9.57031 10 9.50195 10C9.36198 10 9.24316 9.95117 9.14551 9.85352L5 5.70801Z" />
                                            </Grid>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="1">
                                <TextBlock Text="{Binding CurFilterStatus.CurDrives}"
                                           Name="tbDrives"
                                           VerticalAlignment="Center"
                                           FontSize="16"
                                           FontWeight="Bold"
                                           Foreground="{DynamicResource WindowForegroundColor}"></TextBlock>
                                <Button Visibility="{Binding CurFilterStatus.ShowDrives, Converter={StaticResource BoolVisibilityInverseConverter}}"
                                        Command="{Binding ShowDrivesCommand}"
                                        Background="Transparent"
                                        FontSize="16"
                                        BorderThickness="1"
                                        Cursor="Hand"
                                        Margin="3,0,20,0"
                                        Foreground="{DynamicResource WindowForegroundColor}">
                                    <Button.Template>
                                        <ControlTemplate>
                                            <TextBlock VerticalAlignment="Center"
                                                       Text="∨"
                                                       FontSize="16"
                                                       FontWeight="Thin">
                                            </TextBlock>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                                <Button Visibility="{Binding CurFilterStatus.ShowDrives, Converter={StaticResource BoolVisibilityConverter}}"
                                        Command="{Binding ShowDrivesCommand}"
                                        Background="Transparent"
                                        FontSize="16"
                                        BorderThickness="1"
                                        Cursor="Hand"
                                        Margin="3,0,20,0"
                                        Foreground="{DynamicResource WindowForegroundColor}">
                                    <Button.Template>
                                        <ControlTemplate>
                                            <TextBlock VerticalAlignment="Center"
                                                       Text="∧"
                                                       FontSize="16"
                                                       FontWeight="Thin">
                                            </TextBlock>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                                <Popup Name="popupDrives"
                                       IsOpen="{Binding CurFilterStatus.ShowDrives}"
                                       PlacementTarget="{Binding ElementName=tbDrives}"
                                       Placement="Bottom"
                                       VerticalOffset="-1">
                                    <Border Margin="0 0 0 0"
                                            BorderThickness="0"
                                            BorderBrush="#6b6b6b"
                                            CornerRadius="3"
                                            Width="110"
                                            Height="Auto"
                                            VerticalAlignment="Stretch"
                                            HorizontalAlignment="Stretch">
                                        <ListView SelectionMode="Multiple"
                                                  FontSize="16"
                                                  ItemsSource="{Binding Drives,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                  Background="{DynamicResource WindowBackgroundColor}">
                                            <ListView.ItemTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsChecked="{Binding IsSelected,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                              Foreground="{DynamicResource WindowForegroundColor}"
                                                              VerticalAlignment="Center"
                                                              VerticalContentAlignment="Center"
                                                              Content="{Binding Name}"></CheckBox>
                                                </DataTemplate>
                                            </ListView.ItemTemplate>
                                        </ListView>
                                    </Border>
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="MouseEnter">
                                            <i:InvokeCommandAction Command="{Binding ShowDrivesCommand}"
                                                                   CommandParameter="MouseEnter" />
                                        </i:EventTrigger>
                                        <i:EventTrigger EventName="MouseLeave">
                                            <i:InvokeCommandAction Command="{Binding ShowDrivesCommand}"
                                                                   CommandParameter="MouseLeave" />
                                        </i:EventTrigger>
                                        <i:EventTrigger EventName="MouseDown">
                                            <i:InvokeCommandAction Command="{Binding ShowDrivesCommand}"
                                                                   CommandParameter="MouseDown" />
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </Popup>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="2">
                                <TextBlock Name="tbTypes"
                                           Text="{Binding CurFilterStatus.CurType}"
                                           VerticalAlignment="Center"
                                           FontSize="16"
                                           FontWeight="Bold"
                                           Foreground="{DynamicResource WindowForegroundColor}"></TextBlock>
                                <Button Visibility="{Binding CurFilterStatus.ShowTypes, Converter={StaticResource BoolVisibilityInverseConverter}}"
                                        Grid.Column="1"
                                        Command="{Binding ShowTypesCommand}"
                                        Background="Transparent"
                                        FontSize="16"
                                        BorderThickness="1"
                                        Cursor="Hand"
                                        Margin="3,0,20,0"
                                        Foreground="{DynamicResource WindowForegroundColor}">
                                    <Button.Template>
                                        <ControlTemplate>
                                            <TextBlock VerticalAlignment="Center"
                                                       Text="∨"
                                                       FontSize="16"
                                                       FontWeight="Thin">
                                            </TextBlock>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                                <Button Visibility="{Binding CurFilterStatus.ShowTypes, Converter={StaticResource BoolVisibilityConverter}}"
                                        Command="{Binding ShowTypesCommand}"
                                        Background="Transparent"
                                        FontSize="16"
                                        BorderThickness="1"
                                        Cursor="Hand"
                                        Margin="3,0,20,0"
                                        Foreground="{DynamicResource WindowForegroundColor}">
                                    <Button.Template>
                                        <ControlTemplate>
                                            <TextBlock VerticalAlignment="Center"
                                                       Text="∧"
                                                       FontSize="16"
                                                       FontWeight="Thin">
                                            </TextBlock>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                                <Popup Name="popupTypes"
                                       IsOpen="{Binding CurFilterStatus.ShowTypes}"
                                       PlacementTarget="{Binding ElementName=tbTypes}"
                                       Placement="Bottom"
                                       VerticalOffset="-1">
                                    <Border Margin="0 0 0 0"
                                            BorderThickness="0"
                                            BorderBrush="#6b6b6b"
                                            CornerRadius="3"
                                            Width="110"
                                            Height="Auto"
                                            VerticalAlignment="Stretch"
                                            HorizontalAlignment="Stretch">
                                        <ListView SelectionMode="Single"
                                                  FontSize="16"
                                                  ItemsSource="{Binding Types}"
                                                  SelectedItem="{Binding SelectedType,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                  Background="{DynamicResource WindowBackgroundColor}">
                                            <ListView.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Foreground="{DynamicResource WindowForegroundColor}"
                                                               VerticalAlignment="Center"
                                                               Text="{Binding Name}"></TextBlock>
                                                </DataTemplate>
                                            </ListView.ItemTemplate>
                                        </ListView>
                                    </Border>
                                </Popup>
                            </StackPanel>
                            <Button Grid.Column="3"
                                    Command="{Binding ResetFilterCommand}"
                                    Background="Transparent"
                                    FontSize="16"
                                    BorderThickness="1"
                                    Cursor="Hand"
                                    Margin="0,0,0,0"
                                    Foreground="{DynamicResource WindowForegroundColor}">
                                <Button.Template>
                                    <ControlTemplate>
                                        <TextBlock Text="↺"
                                                   FontSize="30"
                                                   FontWeight="Thin">
                                        </TextBlock>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </Border>

                    <TextBlock Margin="15,36,0,0"
                               Grid.Row="1"
                               Text="We didn't find anything to show here."
                               FontWeight="Normal"
                               FontSize="14"
                               Foreground="{DynamicResource WindowForegroundColor}">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>
                                            <Condition Binding="{Binding CurFilterStatus.ItemsCount}" Value="0" />
                                            <Condition Binding="{Binding CurSearchStatus.IsLoading}" Value="False" />
                                        </MultiDataTrigger.Conditions>
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </MultiDataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style></TextBlock>
                    <StackPanel Grid.Row="2">
                        <DataGrid x:Name="ListOfDriveItems"
                              Grid.Row="2"
                              ItemsSource="{Binding FoldersItemList}"
                              Visibility="{Binding CurFilterStatus.ItemsCount, Converter={StaticResource ZeroIntVisibilityConverter}}"
                              SelectedItem="{Binding SelectedFileFolderItem,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                              ColumnHeaderStyle="{StaticResource DGHeaderStyle}"
                              RowStyle="{StaticResource DGRowStyle}"
                              CellStyle="{StaticResource DGCellStyle}" 
                              Style="{StaticResource DGStyle}" Sorting="ListOfDriveItems_Sorting"
                              SelectionMode="Single"
                              SelectionUnit="FullRow" 
                              AllowDrop="True">
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="MouseDoubleClick">
                                    <i:InvokeCommandAction Command="{Binding FolderItemDoubleClickCommand}" />
                                </i:EventTrigger>
                                <i:EventTrigger EventName="DragLeave">
                                    <i:InvokeCommandAction Command="{Binding FolderItemDoubleClickCommand}" />
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                            <DataGrid.Columns>
                                <DataGridTemplateColumn MinWidth="70"
                                                    Width="auto">
                                    <DataGridTemplateColumn.Header>
                                        <Grid Margin="23 0 0 0" HorizontalAlignment="Center" >
                                            <Path Stretch="None" Height="16" Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGHeaderFile1of6Geometry}"/>
                                            <Path Stretch="None" Height="16" Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGHeaderFile2of6Geometry}"/>
                                            <Path Stretch="None" Height="16" Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGHeaderFile3of6Geometry}"/>
                                            <Path Stretch="None" Height="16" Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGHeaderFile4of6Geometry}"/>
                                            <Path Stretch="None" Height="16" Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGHeaderFile5of6Geometry}"/>
                                            <Path Stretch="None" Height="16" Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGHeaderFile6of6Geometry}"/>
                                        </Grid>
                                    </DataGridTemplateColumn.Header>

                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Image Height="25"
                                               Width="25"
                                               Source="{Binding IconSource}" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!--ElementStyle="{StaticResource Centering}"-->
                                <DataGridTextColumn Width="*"
                                                MinWidth="250" SortMemberPath="Name" 
                                                ElementStyle="{StaticResource Centering}"
                                                Binding="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" >
                                    <DataGridTextColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Name"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,10,0" />
                                          

                                            <Grid Height="25" VerticalAlignment="Center">
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding DataContext.IsDriveItemsGridNameAscending, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Value="True">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Grid.Style>
                                                <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGUpArrow1of3Geometry}"/>
                                                <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGUpArrow2of3Geometry}"/>
                                                <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGUpArrow3of3Geometry}"/>
                                            </Grid>

                                            <Grid Height="25" VerticalAlignment="Center">
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding DataContext.IsDriveItemsGridNameAscending, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Value="False">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Grid.Style>
                                                <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGDownArrow1of3Geometry}"/>
                                                <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGDownArrow2of3Geometry}"/>
                                                <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGDownArrow3of3Geometry}"/>
                                            </Grid>

                                            <Button Grid.Column="3"
                                                Command="{Binding DataContext.ResetSortFilterCommand, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}"
                                                Background="{StaticResource WindowBackgroundColor}"
                                                            FontSize="20"
                                                BorderThickness="1"
                                                Cursor="Hand" FocusVisualStyle="{x:Null}"
                                                VerticalAlignment="Center"
                                                Margin="10,0,0,0"
                                                Foreground="{DynamicResource WindowForegroundColor}">
                                                <Button.Template>
                                                    <ControlTemplate>
                                                        <Grid Height="20" Width="24" VerticalAlignment="Center">
                                                            <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGBtnRefresh1of3Geometry}"/>
                                                            <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGBtnRefresh2of3Geometry}"/>
                                                            <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGBtnRefresh3of3Geometry}"/>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Button.Template>
                                            </Button>
                                        </StackPanel>
                                    </DataGridTextColumn.Header>
                                </DataGridTextColumn>

                                <!--<DataGridTextColumn Width="*"
                                                MinWidth="250"
                                                Header="Name"
                                                ElementStyle="{StaticResource Centering}"
                                                Binding="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />-->

                                <DataGridTemplateColumn MinWidth="80"
                                                    Width="auto">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition></ColumnDefinition>
                                                    <ColumnDefinition></ColumnDefinition>
                                                </Grid.ColumnDefinitions>
                                                <Grid Grid.Column="0"
                                                  Visibility="{Binding Type, Converter={StaticResource DirFileTypeVisibilityConverter}}">
                                                    <Button x:Name="btnStar"
                                                        ToolTip="Set this item as default"
                                                        Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=UserControl}, Path=DataContext.StarCommand}"
                                                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=DataContext}"
                                                        Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"
                                                        BorderThickness="0"
                                                        Margin="0 5 5 5"
                                                        Width="30"
                                                        Height="30">
                                                        <Button.Style>
                                                            <Style  TargetType="Button" BasedOn="{StaticResource PinButtonStyle}">
                                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                                <Style.Triggers>
                                                                    <MultiDataTrigger >
                                                                        <MultiDataTrigger.Conditions>
                                                                            <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsMouseOver}" Value="True" />
                                                                            <Condition Binding="{Binding IsDefault}" Value="False" />
                                                                        </MultiDataTrigger.Conditions>
                                                                        <Setter Property="Visibility" Value="Visible"/>
                                                                    </MultiDataTrigger>
                                                                    <MultiDataTrigger >
                                                                        <MultiDataTrigger.Conditions>
                                                                            <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected}" Value="True" />
                                                                            <Condition Binding="{Binding IsDefault}" Value="False" />
                                                                        </MultiDataTrigger.Conditions>
                                                                        <Setter Property="Visibility" Value="Visible"/>
                                                                    </MultiDataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                        <Path Data="{StaticResource StarGeometry}" Style="{StaticResource PinStarPathIconStyle}" />
                                                    </Button>
                                                    <Button x:Name="btnUnstar"
                                                        ToolTip="Unset this item as default"
                                                        Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=UserControl}, Path=DataContext.UnstarCommand}"
                                                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=DataContext}"
                                                        Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"
                                                        Visibility="{Binding IsDefault, Converter={StaticResource BoolVisibilityConverter}}"
                                                        BorderThickness="0"
                                                        Margin="0 5 5 5"
                                                        Width="30" Style="{StaticResource PinButtonStyle}"
                                                        Height="30">
                                                        <Path Data="{StaticResource FilledStarGeometry}" Style="{StaticResource PinStarPathIconStyle}" />
                                                    </Button>
                                                </Grid>
                                                <Grid Grid.Column="1">
                                                    <Button x:Name="btnPin"
                                                        ToolTip="Pin this item to the list"
                                                        Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=UserControl}, Path=DataContext.PinCommand}"
                                                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=DataContext}"
                                                        Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"
                                                        BorderThickness="0"
                                                        Margin="5 5 0 5"
                                                        Width="30"
                                                        Height="30">

                                                        <Button.Style>
                                                            <Style  TargetType="Button" BasedOn="{StaticResource PinButtonStyle}">
                                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                                <Style.Triggers>
                                                                    <MultiDataTrigger >
                                                                        <MultiDataTrigger.Conditions>
                                                                            <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsMouseOver}" Value="True" />
                                                                            <Condition Binding="{Binding IsPined}" Value="False" />
                                                                            <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.IsPinLimitReached}" Value="False" />
                                                                        </MultiDataTrigger.Conditions>
                                                                        <Setter Property="Visibility" Value="Visible"/>
                                                                    </MultiDataTrigger>
                                                                    <MultiDataTrigger >
                                                                        <MultiDataTrigger.Conditions>
                                                                            <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected}" Value="True" />
                                                                            <Condition Binding="{Binding IsPined}" Value="False" />
                                                                            <Condition Binding="{Binding RelativeSource={RelativeSource AncestorType=UserControl}, Path=DataContext.IsPinLimitReached}" Value="False" />
                                                                        </MultiDataTrigger.Conditions>
                                                                        <Setter Property="Visibility" Value="Visible"/>
                                                                    </MultiDataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                        <Path Data="{StaticResource PinGeometry}" Style="{StaticResource PinStarPathIconStyle}" />
                                                    </Button>
                                                    <Button x:Name="btnUnpin"
                                                        ToolTip="Unpin this item from the list"
                                                        Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=UserControl}, Path=DataContext.UnpinCommand}"
                                                        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=DataContext}"
                                                        Background="{DynamicResource DriveNavigationBtnBackgrounfColor}"
                                                        Visibility="{Binding IsPined, Converter={StaticResource BoolVisibilityConverter}}"
                                                        BorderThickness="0"
                                                        Margin="5 5 0 5"
                                                        Width="30" Style="{StaticResource PinButtonStyle}"
                                                        Height="30">
                                                        <Path Data="{StaticResource UnPinGeometry}" Style="{StaticResource PinStarPathIconStyle}" />
                                                    </Button>
                                                </Grid>
                                            </Grid>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTextColumn Width="Auto"
                                                MinWidth="250"
                                                 SortMemberPath="DateModified"
                                                ElementStyle="{StaticResource Centering}"
                                                    Binding="{Binding LastModifiedDateTime,Converter={StaticResource DateTimeConverter}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <DataGridTextColumn.Header>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Date Modified"
                                              VerticalAlignment="Center"
                                              Margin="0,0,10,0" />
                                         

                                            <Grid Height="25" VerticalAlignment="Center">
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding DataContext.IsDriveItemsGridDateAscending, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Value="True">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Grid.Style>
                                                <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGUpArrow1of3Geometry}"/>
                                                <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGUpArrow2of3Geometry}"/>
                                                <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGUpArrow3of3Geometry}"/>
                                            </Grid>

                                            <Grid Height="25" VerticalAlignment="Center">
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding DataContext.IsDriveItemsGridDateAscending, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Value="False">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Grid.Style>
                                                <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGDownArrow1of3Geometry}"/>
                                                <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGDownArrow2of3Geometry}"/>
                                                <Path Fill="{DynamicResource SecondaryWindowForegroundColor}" Data="{StaticResource DGDownArrow3of3Geometry}"/>
                                            </Grid>
                                        </StackPanel>
                                    </DataGridTextColumn.Header>
                                </DataGridTextColumn>
                            </DataGrid.Columns>
                            <DataGrid.ContextMenu>
                                <ContextMenu StaysOpen="False">
                                    <MenuItem Header="Open"
                                          Command="{Binding OpenItemCommand}"
                                          CommandParameter="{Binding Path=PlacementTarget.SelectedItem, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                          Height="35" />
                                    <MenuItem Header="Copy path to clipboard"
                                          Command="{Binding CopyItemPathCommand}"
                                          CommandParameter="{Binding Path=PlacementTarget.SelectedItem, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                          Height="35" />
                                    <MenuItem Header="Rename"
                                          Command="{Binding RenameItemCommand}"
                                          CommandParameter="{Binding Path=PlacementTarget.SelectedItem, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                          Height="35" />
                                    <MenuItem Header="Delete"
                                          Command="{Binding DeleteItemCommand}"
                                          CommandParameter="{Binding Path=PlacementTarget.SelectedItem, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                          Height="35" />
                                </ContextMenu>
                            </DataGrid.ContextMenu>
                        </DataGrid>
                        <!--Animated Loader-->
                        <StackPanel Orientation="Horizontal" Margin="50 10" HorizontalAlignment="Left" Visibility="{Binding CurSearchStatus.IsLoading,Converter={StaticResource BoolVisibilityConverter},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}">

                            <common:AnimatedCircle CurrentIndex="2" Width="15" Height="15" Margin="10,5" Background="#616161" CornerRadius="100"/>
                            <common:AnimatedCircle CurrentIndex="1" Width="15" Height="15" Margin="10,5" Background="#616161" CornerRadius="100"/>
                            <common:AnimatedCircle CurrentIndex="0" Width="15" Height="15" Margin="10,5" Background="#616161" CornerRadius="100"/>

                        </StackPanel>
                    </StackPanel>
                    <!--<Image gif:ImageBehavior.AnimatedSource="/CDM;component/Resources/loading.gif"
                                       Grid.Row="3" HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Visibility="{Binding CurSearchStatus.IsLoadingItems,Converter={StaticResource BoolVisibilityConverter}}"
                                       Width="40" Height="8" Margin="0,10,0,10" />-->
                </Grid>

                <!--Rename Window-->
                <Grid Grid.Row="2"
                      Name="RenameWindow"
                      Visibility="{Binding CurRenameStatus.IsDoing, Converter={StaticResource BoolVisibilityConverter}}">
                    <Grid.Background>
                        <SolidColorBrush Color="LightGray"
                                         Opacity="0.5" />
                    </Grid.Background>
                    <Border Margin="0 0 0 0"
                            BorderThickness="1"
                            BorderBrush="#6b6b6b"
                            CornerRadius="5"
                            Width="300"
                            Height="150"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Center"
                            Background="{DynamicResource WindowBackgroundColor}">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="50"></RowDefinition>
                                <RowDefinition Height="30"></RowDefinition>
                                <RowDefinition Height="70"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition></ColumnDefinition>
                                <ColumnDefinition></ColumnDefinition>
                                <ColumnDefinition></ColumnDefinition>
                                <ColumnDefinition></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Rename"
                                       Grid.Row="0"
                                       Grid.Column="0"
                                       Grid.ColumnSpan="3"
                                       Foreground="{DynamicResource WindowForegroundColor}">
                            </TextBlock>
                            <Button Grid.Row="0"
                                    Grid.Column="3"
                                    HorizontalAlignment="Right"
                                    Command="{Binding CancelRenameCommand}"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Foreground="{DynamicResource WindowForegroundColor}">
                                <Button.Template>
                                    <ControlTemplate>
                                        <TextBlock Text="X">
                                        </TextBlock>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver"
                                                     Value="True">
                                                <Trigger.EnterActions>
                                                    <BeginStoryboard>
                                                        <Storyboard>

                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </Trigger.EnterActions>
                                                <Trigger.ExitActions>
                                                    <BeginStoryboard>
                                                        <Storyboard>

                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </Trigger.ExitActions>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            <Border Grid.Row="1"
                                    Grid.Column="0"
                                    Grid.ColumnSpan="4"
                                    BorderThickness="1"
                                    CornerRadius="5"
                                    Background="#B0B0B0"
                                    BorderBrush="#929292">
                                <TextBox Grid.Row="1"
                                         Grid.Column="0"
                                         Grid.ColumnSpan="4"
                                         Margin="2 "
                                         MinLines="1"
                                         MaxLines="1"
                                         Background="#B0B0B0"
                                         Name="txtRename"
                                         Text="{Binding CurRenameStatus.Name, Mode = TwoWay, UpdateSourceTrigger = PropertyChanged}">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="TextChanged">
                                            <i:InvokeCommandAction Command="{Binding RenameTextChangedCommand}"></i:InvokeCommandAction>
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </TextBox>
                            </Border>
                            <Popup Name="tipRenameError"
                                   IsOpen="{Binding CurRenameStatus.IsError}"
                                   PlacementTarget="{Binding ElementName=txtRename}"
                                   Placement="Bottom"
                                   VerticalOffset="-1">
                                <Border Margin="0 0 0 0"
                                        BorderThickness="1"
                                        BorderBrush="#6b6b6b"
                                        CornerRadius="3"
                                        Width="400"
                                        Height="30"
                                        VerticalAlignment="Stretch"
                                        HorizontalAlignment="Stretch"
                                        Background="{DynamicResource WindowBackgroundColor}">
                                    <TextBlock Text="{Binding CurRenameStatus.Desc}"
                                               Name="txtRenameError"
                                               Foreground="#E6B6B4"
                                               Padding="5">
                                    </TextBlock>
                                </Border>
                            </Popup>
                            <Button Grid.Row="2"
                                    Grid.Column="2"
                                    IsDefault="True"
                                    Visibility="{Binding CurRenameStatus.IsError, Converter={StaticResource BoolVisibilityInverseConverter}}"
                                    HorizontalAlignment="Right"
                                    Cursor="Hand"
                                    BorderThickness="0"
                                    Command="{Binding DoRenameCommand}">
                                <Button.Template>
                                    <ControlTemplate>
                                        <Border Width="60"
                                                Height="25"
                                                BorderThickness="1"
                                                CornerRadius="3"
                                                BorderBrush="#929292"
                                                Background="#B0B0B0">
                                            <TextBlock HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       Text="OK"></TextBlock>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            <Button Grid.Row="2"
                                    Grid.Column="3"
                                    IsCancel="True"
                                    HorizontalAlignment="Right"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Command="{Binding CancelRenameCommand}">
                                <Button.Template>
                                    <ControlTemplate>
                                        <Border Width="60"
                                                Height="25"
                                                BorderThickness="1"
                                                CornerRadius="3"
                                                BorderBrush="#929292"
                                                Background="#B0B0B0">
                                            <TextBlock HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       Text="Cancel"></TextBlock>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </Grid>

        <Grid Grid.Row="1"
              Visibility="{Binding Offline,Converter={StaticResource BoolVisibilityConverter}}">
            <Grid.Background>
                <SolidColorBrush Color="LightGray"
                                 Opacity="0.5" />
            </Grid.Background>
        </Grid>



    </Grid>
</UserControl>